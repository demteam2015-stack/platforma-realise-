\'use client\';\n\nimport { useState } from \'react\';\nimport { useAuth } from \'@/context/AuthContext\';\nimport { fetchApi } from \'@/lib/api\'; // ← Импортируем нашу функцию\nimport Button from \'./ui/Button\';\n\ntype RegisterModalProps = {\n  isOpen: boolean;\n  onClose: () => void;\n  onSwitchToLogin: () => void;\n};\n\nexport default function RegisterModal({ isOpen, onClose, onSwitchToLogin }: RegisterModalProps) {\n  const { login } = useAuth(); // Мы будем использовать login из контекста, чтобы обновить состояние\n\n  const [formData, setFormData] = useState({\n    email: \'\',\n    firstName: \'\',\n    lastName: \'\',\n    birthDate: \'\',\n    gender: \'male\',\n  });\n\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  if (!isOpen) return null;\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Отправляем реальный запрос на бэкенд\n      const data = await fetchApi(\'/api/register\', {\n        method: \'POST\',\n        body: JSON.stringify(formData),\n      });\n\n      // Если регистрация успешна, \"логиним\" пользователя в фронтенде\n      // и сохраняем его данные\n      login(data.user); \n      onClose(); // Закрываем модальное окно\n\n    } catch (err: any) {\n      // Устанавливаем сообщение об ошибке, которое вернет наш API\n      setError(err.message || \'Не удалось зарегистрироваться. Попробуйте снова.\');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 animate-fadeIn\">\n      <div className=\"bg-gray-900 border border-gray-700 rounded-3xl p-8 w-full max-w-md relative shadow-2xl shadow-blue-500/10\">\n        <button onClick={onClose} className=\"absolute top-5 right-5 text-gray-400 hover:text-white transition-colors\">&times;</button>\n        <h2 className=\"text-2xl font-bold text-center mb-6 text-white\">Регистрация</h2>\n        \n        <form onSubmit={handleSubmit} className=\"space-y-5\">\n          <input type=\"email\" name=\"email\" placeholder=\"Email\" required onChange={handleChange} className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition\" />\n          <div className=\"flex gap-4\">\n            <input type=\"text\" name=\"firstName\" placeholder=\"Имя\" required onChange={handleChange} className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition\" />\n            <input type=\"text\" name=\"lastName\" placeholder=\"Фамилия\" required onChange={handleChange} className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition\" />\n          </div>\n          <input type=\"date\" name=\"birthDate\" placeholder=\"Дата рождения\" required onChange={handleChange} className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition\" />\n          <select name=\"gender\" onChange={handleChange} className=\"w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition\">\n            <option value=\"male\">Мужчина</option>\n            <option value=\"female\">Женщина</option>\n          </select>\n\n          {error && <p className=\"text-red-400 text-sm text-center\">{error}</p>}\n\n          <Button type=\"submit\" variant=\"primary\" className=\"w-full\" disabled={isLoading}>\n            {isLoading ? \'Создание аккаунта...\' : \'Создать аккаунт\'}\n          </Button>\n        </form>\n\n        <p className=\"text-center text-sm text-gray-400 mt-6\">\n          Уже есть аккаунт?{\' \}\n          <button onClick={onSwitchToLogin} className=\"font-semibold text-blue-400 hover:text-blue-300 transition-colors\">\n            Войти\n          </button>\n        </p>\n      </div>\n    </div>\n  );\n}\n